<!-- AdvancedWinUiDataGrid/build/RpaWinUiComponents.AdvancedWinUiDataGrid.targets -->
<!-- ✅ KOMPLETNE OPRAVENÝ MSBuild targets súbor pre WinUI3 package -->
<Project>

  <!-- ✅ Debug informácie (iba v Debug mode) -->
  <Target Name="DebugAdvancedDataGridPackage" BeforeTargets="ResolveReferences" Condition="'$(Configuration)' == 'Debug' AND '$(UseWinUI)' == 'true'">
    <Message Text="🔍 AdvancedWinUiDataGrid: Package v1.0.2 loaded via NuGet" Importance="normal" />
    <Message Text="🔍 AdvancedWinUiDataGrid: MSBuildThisFileDirectory = $(MSBuildThisFileDirectory)" Importance="normal" />
    <Message Text="🔍 AdvancedWinUiDataGrid: TargetFramework = $(TargetFramework)" Importance="normal" />
  </Target>

  <!-- ✅ Package paths -->
  <PropertyGroup>
    <AdvancedDataGridLibPath>$(MSBuildThisFileDirectory)../lib/$(TargetFramework)/</AdvancedDataGridLibPath>
  </PropertyGroup>

  <!-- ✅ OPRAVENÉ: Pridanie referencie na DLL (bez raw XAML súborov) -->
  <ItemGroup Condition="'$(UseWinUI)' == 'true' AND Exists('$(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.dll')">
    <Reference Include="RpaWinUiComponents.AdvancedWinUiDataGrid">
      <HintPath>$(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.dll</HintPath>
      <Private>False</Private>
    </Reference>
  </ItemGroup>

  <!-- ✅ ODSTRÁNENÉ: Raw XAML import - XAML je už skompilované v DLL -->
  <!-- Pre WinUI3 komponenty, XAML súbory sú skompilované do DLL a nie sú potrebné ako raw súbory -->

  <!-- ✅ Nastavenie pre WinUI3 XAML kompajlovanie -->
  <PropertyGroup Condition="'$(UseWinUI)' == 'true'">
    <EnableDefaultXamlItems>true</EnableDefaultXamlItems>
    <XamlCompilationEnabled>true</XamlCompilationEnabled>
  </PropertyGroup>

  <!-- ✅ Debug target pre verifikáciu package obsahu -->
  <Target Name="VerifyAdvancedDataGridPackage" BeforeTargets="PrepareForBuild" Condition="'$(Configuration)' == 'Debug' AND '$(UseWinUI)' == 'true'">

    <PropertyGroup>
      <PackageDllExists Condition="Exists('$(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.dll')">true</PackageDllExists>
      <PackagePdbExists Condition="Exists('$(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.pdb')">true</PackagePdbExists>
    </PropertyGroup>

    <Message Text="✅ Package DLL found: $(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.dll" Importance="normal"
             Condition="'$(PackageDllExists)' == 'true'" />
    <Message Text="✅ Package PDB found: $(AdvancedDataGridLibPath)RpaWinUiComponents.AdvancedWinUiDataGrid.pdb" Importance="normal"
             Condition="'$(PackagePdbExists)' == 'true'" />

    <Warning Text="⚠️ AdvancedWinUiDataGrid: DLL not found at $(AdvancedDataGridLibPath). Package may not be properly installed."
             Condition="'$(PackageDllExists)' != 'true'" />

    <Message Text="💡 TIP: If package is missing, try: dotnet restore --force" Importance="high"
             Condition="'$(PackageDllExists)' != 'true'" />
  </Target>

  <!-- ✅ WinUI3 specific settings -->
  <PropertyGroup Condition="'$(UseWinUI)' == 'true'">
    <!-- Zabezpečiť že WinUI3 ResourceDictionary sú správne načítané -->
    <XamlResourcesEnabled>true</XamlResourcesEnabled>
  </PropertyGroup>

</Project>